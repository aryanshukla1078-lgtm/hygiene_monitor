<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Swachh Scan ‚Äî Public Hygiene Feedback</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
  <div class="max-w-2xl mx-auto p-6 space-y-6">
    <h1 class="text-2xl font-semibold">Public Hygiene Feedback</h1>

    <!-- Sign-in buttons -->
    <div class="flex space-x-4">
      <a href="admin.html" class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-700">
        üîë Admin Sign In
      </a>
      <a href="staff.html" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-500">
        üë∑ Staff Sign In
      </a>
    </div>

    <label class="block">
      <span class="text-sm text-gray-600">Select location</span>
      <select id="location" class="mt-1 w-full border p-2 rounded">
        <option value="Location1">Location 1</option>
        <option value="Location2">Location 2</option>
        <option value="Location3">Location 3</option>
      </select>
    </label>

    <div class="grid grid-cols-1 gap-4">
      <div class="flex items-center justify-between">
        <span>Cleanliness</span>
        <div id="cleanliness" class="stars"></div>
      </div>
      <div class="flex items-center justify-between">
        <span>Water/Soap availability</span>
        <div id="waterSoap" class="stars"></div>
      </div>
      <div class="flex items-center justify-between">
        <span>Overall hygiene</span>
        <div id="hygiene" class="stars"></div>
      </div>
      <div class="flex items-center justify-between">
        <span>Odor</span>
        <div id="odor" class="stars"></div>
      </div>
    </div>

    <textarea id="comment" class="w-full border p-2 rounded" placeholder="Optional comment"></textarea>

    <button id="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Submit feedback</button>

    <div id="status" class="text-sm"></div>
  </div>

  <script>
    const state = { cleanliness: 0, waterSoap: 0, hygiene: 0, odor: 0 };

    function makeStars(id) {
      const el = document.getElementById(id);
      el.innerHTML = '';
      for (let s = 1; s <= 5; s++) {
        const b = document.createElement('button');
        b.textContent = '‚òÖ';
        b.className = 'text-2xl mx-1 ' + (s <= state[id] ? 'text-yellow-500' : 'text-gray-300');
        b.onclick = () => { state[id] = s; makeStars(id); };
        el.appendChild(b);
      }
    }
    ['cleanliness','waterSoap','hygiene','odor'].forEach(makeStars);

    document.getElementById('submit').onclick = async () => {
      const locationId = document.getElementById('location').value;
      const comment = document.getElementById('comment').value;
      const payload = { 
        locationId, 
        cleanliness: state.cleanliness, 
        waterSoap: state.waterSoap, 
        hygiene: state.hygiene, 
        odor: state.odor, 
        comment 
      };

      try {
        const res = await fetch(
          "https://script.google.com/macros/s/AKfycbxA75Wu1SUWPR8j2odOfVIgLBi3APolpYaG0HQXsMKWUBxFOjJo35oTXXaKW4jjYd3A/exec",
          { 
            method: "POST", 
            headers: { "Content-Type": "application/json" }, 
            body: JSON.stringify(payload) 
          }
        );

        const status = document.getElementById('status');
        if (res.ok) { 
          status.textContent = '‚úÖ Thanks! Your feedback was submitted.';
          status.className = 'text-sm text-green-700';
          document.getElementById('comment').value = '';
        } else { 
          status.textContent = '‚ùå Error submitting feedback.';
          status.className = 'text-sm text-red-700';
        }
      } catch (err) {
        const status = document.getElementById('status');
        status.textContent = '‚ùå Network error. Please try again.';
        status.className = 'text-sm text-red-700';
      }
    };
  </script>
</body>
</html>
